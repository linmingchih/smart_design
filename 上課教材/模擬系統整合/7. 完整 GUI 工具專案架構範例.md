## 完整 GUI 工具專案架構範例生成請求（PyWebView + PyEDB/PyAEDT + uv + Git）

請依以下規格，產生使用 **PyWebView + PyEDB/PyAEDT + uv + Git** 的完整 GUI 工具專案架構、所有必要的程式碼與檔案內容。

### 一、 開發環境與核心架構

  * **GUI 框架**: 使用 **PyWebView** (基於 HTML/CSS/JS)。
  * **後端 API 模擬**: 核心功能使用 **PyEDB / PyAEDT** 模擬。
  * **環境管理**: 專案使用 **uv** 進行環境與依賴管理。
  * **版本控制**: 專案結構需包含 **Git** 相關檔案。
  * **設計生命週期 (Design Lifecycle)**:
      * 工具啟動時，若無已開啟**設計**，在 `%TEMP%` 自動建立一個臨時**設計**資料夾，例如 `design1.vw/`。
      * 支援 **New / Open / Save / Save As** 行為。
      * **Save / Save As**: 將當前**設計**狀態（包括 GUI 輸入的參數）儲存到**設計**資料夾design1.vw內的 `design.json` 檔案中。
      * **Open**: 選擇一個**設計**資料夾，載入其中的 `design.json` 內容到 GUI 介面。

### 📁 二、 專案目錄結構與必要檔案內容

AI 必須產生以下所有目錄和檔案的內容，確保結構完整且檔案內容可用：

```
project_root/
    .gitattributes              <-- 新增：規範 Git 屬性
    .gitignore                  <-- Git 忽略設定：忽略 .venv, project_design_temp, .aedb 等
    .python-version             <-- 指定 Python 版本，例如：3.11
    config.json                 <-- 專案配置元數據 (Project Metadata)
    pyproject.toml              <-- uv 配置，包含專案依賴 (Dependencies)
    README.md
    README_zh-TW.md
    run.bat                     <-- 啟動腳本 (檢查 uv, 安裝依賴, 啟動主程式)
    src/
        __init__.py
        main.py                 <-- PyWebView GUI 主程式，處理窗口配置
        project_manager.py      <-- 處理 New/Open/Save/Save As, design.json 讀寫, 專案路徑管理
        gui_backend.py          <-- 處理 PyWebView expose 的所有後端邏輯、非同步執行、subprocess 調用與日誌回傳
        gui/
            index.html          <-- GUI 主介面
            css/
                style.css       <-- 基礎樣式 (包含三段式佈局 CSS)
            js/
                main.js         <-- 介面初始化、全域邏輯、通訊 (File Menu, Config Dialog, Message Window)
                tab_preprocess.js <-- Preprocess Tab 邏輯 (參數儲存, 繪圖預覽模擬, 執行 Preprocess)
                tab_simulation.js <-- Simulation Tab 邏輯 (參數儲存, 執行 Simulation)
                tab_postprocess.js <-- Postprocess Tab 邏輯 (圖表初始化, 數據載入, 圖表控制)
    scripts/
        preprocess.py           <-- 由後端執行，讀取 design.json 執行 PyEDB/PyAEDT 模擬，並回傳 .aedb 路徑。
        simulation.py           <-- 由後端執行，讀取 design.json 執行 PyAEDT 模擬，並回傳 result.json (S參數)。
```

### 🖼️ 三、 GUI 佈局規格 (HTML/CSS/JS)

GUI 採三段式佈局：Menu Bar / Tool Bar、Tab Pages、Message Window。

1.  **Menu Bar / Tool Bar (頂部)**

      * **File 菜單**:
          * New (新建臨時**設計**資料夾並清空介面)
          * Open (開啟現有**設計**目錄，載入 `design.json`)
          * Save (儲存至當前**設計**目錄的 `design.json`)
          * Save As (儲存**設計**目錄為新名稱)
          * Exit
      * **Option 菜單**:
          * Version: 彈出對話框 (Dialog)，顯示並允許使用者編輯 `config.json` 中的 `aedt_version` 和 `edb_version` 兩個欄位。
      * **Help 菜單**:
          * About: 顯示專案名稱、版本、作者、版權等資訊（從 `config.json` 讀取）。

2.  **Tab Pages (中央區域)**

      * 包含三個主要頁籤：**Preprocess**、**Simulation**、**Postprocess**。
      * 每個 Tab 內的邏輯和事件處理必須寫在**獨立的 `.js` 檔案中**。
      * **`Preprocess` 頁籤規格**:
          * **參數 Panel (左)**:
              * 輸入欄位：`line_width`, `line_thickness`, `line_length`, `dielectric_width`, `dielectric_thickness`, `dielectric_permittivity`, `dielectric_loss_tangent`（包含預設值）。
          * **預覽 Panel (右)**: 顯示 Line 與 Dielectric 的二維形狀**靜態預覽** (使用簡單 div 塊模擬座標系統和形狀)。
          * **Apply 按鈕**: 儲存參數到 `design.json` $\to$ 呼叫 `gui_backend.run_preprocess()` $\to$ 執行 `scripts/preprocess.py`。
      * **`Simulation` 頁籤規格**:
          * **頂部**: 顯示當前**設計**的 `.aedb` 專案路徑。
          * **參數 Panel (左)**:
              * `simulation_type` (下拉選單: 'HFSS', 'SIwave')
              * `max_frequency` (輸入框，預設: '10GHz')
          * **預覽 Panel (右)**: 顯示 3D 結構**靜態預覽**（圖片或簡單文字模擬）。
          * **Apply 按鈕**: 儲存參數到 `design.json` $\to$ 呼叫 `gui_backend.run_simulation()` $\to$ 執行 `scripts/simulation.py`。
      * **`Postprocess` 頁籤規格**:
          * **頂部**: 顯示當前**設計**的 `.aedb` 專案路徑。
          * **控制 Panel (左)**: S 參數顯示模式切換（`mag`, `db`, `phase`, `real`, `imag`）。
          * **圖表 Panel (右)**: 顯示**動態圖表**（使用 **Chart.js** 模擬），實現 **Zoom In/Out, Pan, Reset View** 功能。數據來自 `result.json`。

3.  **Message Window (底部)**

      * 全域共用，即時顯示 Python 後端（包括腳本）執行的**進度或日誌訊息**。
      * **清除按鈕**。
      * 每次切換**設計** (New/Open) 時自動重置。

### 💡 四、 Python 腳本執行與非同步機制

  * **腳本執行**: `preprocess.py` 和 `simulation.py` 必須透過 `subprocess.Popen()` 執行，確保不阻塞 GUI。
  * **非同步通訊**: 實現前端 (JS) $\leftrightarrow$ 後端 (Python) 的即時日誌傳輸：
    1.  `gui_backend.py` 內使用 **獨立的 Thread** 處理 `subprocess.Popen`。
    2.  捕獲 `Popen` 進程的 **Stdout/Stderr**。
    3.  使用 `pywebview.api.log_message(message)` (或其他 exposed function) 將訊息**即時回傳**給前端 Message Window。

### ⚙️ 五、 `run.bat` 啟動腳本要求

生成完整的 `run.bat` 腳本，實現以下功能：

1.  **檢查 `uv`**: 檢查系統是否已安裝 `uv`。
2.  **自動安裝 `uv`**: 若未安裝，自動下載並安裝 `uv`。
3.  **環境設置**: 使用 `uv tool run python` 讀取 `.python-version` 確保環境版本。
4.  **安裝依賴**: 執行 `uv sync` 建立/同步虛擬環境 (`.venv/`) 和依賴。
5.  **啟動 GUI**: 以**隱藏 Console 視窗**的方式，啟動 `src/main.py`。

### 📋 六、 參數與通訊流程重點

  * **`config.json` 欄位**: 必須包含 `aedt_version`, `edb_version`, `project_name`, `version`, `author`, `copyright`。
  * **`design.json` 欄位**: 必須能儲存 Preprocess 和 Simulation 頁籤的所有使用者輸入參數，以及腳本執行結果 (`aedb_path`, `result_json_path`)。
